"use strict";(self.webpackChunkcassamedicalclinic=self.webpackChunkcassamedicalclinic||[]).push([[294],{294:(F,m,n)=>{n.r(m),n.d(m,{EditArticleModule:()=>v});var d=n(177),a=n(4341),s=n(6448),u=n(1432),t=n(540),h=n(8956);const p=["editor"];function f(l,A){if(1&l&&t.nrm(0,"img",28),2&l){const r=t.XpG();t.Y8G("src",r.article.imageUrl,t.B4B)}}const g=[{path:":id",component:(()=>{class l{constructor(r,e,i){this.route=r,this.router=e,this.articleService=i,this.article=null,this.loading=!0,this.selectedFile=null}ngOnInit(){this.jodit=u.x.make(this.editorElement.nativeElement,{height:400,toolbarSticky:!0,uploader:{insertImageAsBase64URI:!0},placeholder:"Start typing here..."}),this.jodit.events.on("change",r=>{this.article.description=r}),this.loadArticle()}loadArticle(){const r=this.route.snapshot.paramMap.get("id");r&&this.articleService.getArticleById(r).subscribe({next:e=>{this.article=e;const i=Array.isArray(e.description)?e.description.join("\n"):e.description||"";this.jodit&&(this.jodit.value=i),this.article.date&&(this.article.date=this.article.date.split("T")[0]),this.loading=!1,console.log("Article loaded successfully:",e)},error:e=>{console.error("Error fetching article:",e),this.loading=!1}})}onFileSelected(r){this.selectedFile=r.target.files[0]||null}updateArticle(){if(!this.article)return;const r=new FormData;r.append("title",this.article.title),r.append("description",JSON.stringify((this.jodit?this.jodit.value:"").split("\n").filter(i=>""!==i.trim()))),this.article.date&&r.append("date",this.article.date),this.selectedFile&&r.append("image",this.selectedFile),this.articleService.updateArticle(this.article._id,r).subscribe({next:()=>{alert("Article updated successfully!"),this.router.navigate(["/admin/articles"])},error:i=>{console.error("Update error:",i),alert("Failed to update article.")}})}ngOnDestroy(){this.jodit&&this.jodit.destruct()}static{this.\u0275fac=function(e){return new(e||l)(t.rXU(s.nX),t.rXU(s.Ix),t.rXU(h.q))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-edit-article"]],viewQuery:function(e,i){if(1&e&&t.GBs(p,7),2&e){let c;t.mGM(c=t.lsd())&&(i.editorElement=c.first)}},decls:48,vars:9,consts:[[1,"container-fluid","pb-4"],[1,"row"],[1,"col-md-12"],[1,"card","add-article-card"],[1,"card-header"],[1,"p-title-black"],[1,"d-flex","flex-column","text-center","align-items-start"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","/admin/dashboard",1,"no-text-decoration"],["href","/admin/articles",1,"no-text-decoration"],["aria-current","page",1,"breadcrumb-item","active"],["href","#",1,"no-text-decoration"],[1,"card-body"],[1,"mb-3"],[1,"form-label"],["type","text","name","title",1,"form-control",3,"ngModel","placeholder","ngModelChange"],["type","date","name","date",1,"form-control",3,"ngModel","value","ngModelChange"],["type","file","placeholder","Choose an image",1,"form-control",3,"change"],[1,"mb-3","d-flex","flex-column","gap-1"],["class","add-article-img","alt","Current Article Image",3,"src",4,"ngIf"],[1,"mb-3","px-3"],[1,"editor-box"],["editor",""],[1,"card-footer"],[1,"btn","btn-danger","me-2"],[1,"btn","btn-primary","me-2",3,"click"],["alt","Current Article Image",1,"add-article-img",3,"src"]],template:function(e,i){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"p",5),t.EFF(6,"Edit Articles"),t.k0s(),t.j41(7,"div",6)(8,"nav",7)(9,"ol",8)(10,"li",9)(11,"a",10),t.EFF(12,"Dashboard"),t.k0s()(),t.j41(13,"li",9)(14,"a",11),t.EFF(15,"Articles"),t.k0s()(),t.j41(16,"li",12)(17,"a",13),t.EFF(18,"Edit Articles"),t.k0s()()()()()(),t.j41(19,"div",14)(20,"form")(21,"div",15)(22,"label",16),t.EFF(23,"Title"),t.k0s(),t.j41(24,"input",17),t.bIt("ngModelChange",function(o){return i.article.title=o}),t.k0s()(),t.j41(25,"div",15)(26,"label",16),t.EFF(27,"Date"),t.k0s(),t.j41(28,"input",18),t.bIt("ngModelChange",function(o){return i.article.date=o}),t.nI1(29,"date"),t.k0s()(),t.j41(30,"div",15)(31,"label",16),t.EFF(32,"Article Image"),t.k0s(),t.j41(33,"input",19),t.bIt("change",function(o){return i.onFileSelected(o)}),t.k0s()(),t.j41(34,"div",20)(35,"label",16),t.EFF(36,"Current Image"),t.k0s(),t.DNE(37,f,1,1,"img",21),t.k0s()()(),t.j41(38,"div",22)(39,"label",16),t.EFF(40,"Content"),t.k0s(),t.nrm(41,"div",23,24),t.k0s(),t.j41(43,"div",25)(44,"button",26),t.EFF(45,"Cancel"),t.k0s(),t.j41(46,"button",27),t.bIt("click",function(){return i.updateArticle()}),t.EFF(47," Submit "),t.k0s()()()()()()),2&e&&(t.R7$(24),t.Y8G("ngModel",i.article.title)("placeholder",i.article.title||"Enter article title"),t.R7$(4),t.Y8G("ngModel",i.article.date)("value",i.article.date?t.i5U(29,6,i.article.date,"yyyy-MM-dd"):null),t.R7$(9),t.Y8G("ngIf",null==i.article?null:i.article.imageUrl),t.R7$(4),t.BMQ("data-placeholder",i.article.description||"Write article content here..."))},dependencies:[d.bT,a.qT,a.me,a.BC,a.cb,a.vS,a.cV,d.vh]})}}return l})()}];let b=(()=>{class l{static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275mod=t.$C({type:l})}static{this.\u0275inj=t.G2t({imports:[s.iI.forChild(g),s.iI]})}}return l})(),v=(()=>{class l{static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275mod=t.$C({type:l})}static{this.\u0275inj=t.G2t({imports:[d.MD,b,a.YN]})}}return l})()}}]);